# 一道数列题的探究

$$
a_{n+2}=\sqrt{a_{n+1} a_n},a_1=1,a_2=2
$$

## 先上解法

$$
\ln a_{n+2}=\frac{1}{2}(\ln a_{n+1}+\ln a_n)\\
b_n=\ln a_n,2b_{n+2}+b_{n+1}=2b_{n+1}+b_{n}\\
2b_{n+1}+b_n=2\ln 2\\
b_n=\frac{1}{3} 2^{1-n} \left(2 (-1)^n+2^n\right) \ln (2)\\
a_n=e^{b_n}=e^{\frac{1}{3} 2^{1-n} \left(2 (-1)^n+2^n\right) \ln (2)}=2^{\frac{2}{3} \left((-1)^n 2^{1-n}+1\right)}
$$

好了，上面不是重点。

为了让探索多一点乐趣，这里不用通项

```Mathematica
ListLinePlot[
 RecurrenceTable[{a[n + 2] == Sqrt[a[n + 1] a[n]], a[1] == 1.,
   a[2] == 2.}, a, {n, 1, 20}], PlotRange -> All]
```

经过一些波动后趋于平稳

极限值很好解决，通过通项可以得到 $\lim_{n\to \infty}a_n=2^{2/3}$

探索为止了吗？并不

### 不妨将四个平均都试一遍

上面研究的是几何平均

---

算术平均会怎样呢？

$$
a_{n+2}=\frac{a_{n+1}+a_{n}}{2},a_1=1,a_2=2
$$

```Mathematica
ListLinePlot[
 RecurrenceTable[{a[n + 2] == 1/2 (a[n + 1] + a[n]), a[1] == 1.,
   a[2] == 2.}, a, {n, 1, 20}], PlotRange -> All]
```

同样也是趋于平稳

容易得到 $a_n=\frac{1}{3} 2^{-n} \left(4 (-1)^n+5*2^n\right)$ ,$\lim_{n\to \infty}a_n=5/3$

---

平方平均

$$
a_{n+2}=\sqrt{\frac{1}{2} \left(a_{n+1}^2+a_n^2\right)}
$$

解法就是两边平方

趋势也是平稳

```Mathematica
ListLinePlot[
 RecurrenceTable[{a[n + 2] == Sqrt[(a[n + 1]^2 + a[n]^2)/2],
   a[1] == 1., a[2] == 2.}, a, {n, 1, 20}], PlotRange -> All]
```

$$
a_n=\sqrt{2^{-n} \left(4 (-1)^n+3\ 2^n\right)},\lim_{n\to \infty}a_n=\sqrt{3}
$$

---

调和平均

$$
a_{n+2}=\frac{2}{\frac{1}{a_n}+\frac{1}{a_{n+1}}}
$$

解法是取倒数

```Mathematica
ListLinePlot[
 RecurrenceTable[{a[n + 2] == 2/(1/a[n + 1] + 1/a[n]), a[1] == 1.,
   a[2] == 2.}, a, {n, 1, 20}], PlotRange -> All]
```

$$
a_n=-\frac{3\ 2^{n-1}}{(-1)^n-2^n},\lim_{n\to \infty}a_n=3/2
$$

---

四个都探索完了，最后合在一起画一个图

```Mathematica
Show[
 ListLinePlot[
  RecurrenceTable[{a[n + 2] == Sqrt[a[n + 1] a[n]], a[1] == 1.,
    a[2] == 2.}, a, {n, 1, 20}], PlotRange -> All],
 ListLinePlot[
  RecurrenceTable[{a[n + 2] == 1/2 (a[n + 1] + a[n]), a[1] == 1.,
    a[2] == 2.}, a, {n, 1, 20}], PlotRange -> All],
 ListLinePlot[
  RecurrenceTable[{a[n + 2] == Sqrt[(a[n + 1]^2 + a[n]^2)/2],
    a[1] == 1., a[2] == 2.}, a, {n, 1, 20}], PlotRange -> All],
 ListLinePlot[
  RecurrenceTable[{a[n + 2] == 2/(1/a[n + 1] + 1/a[n]), a[1] == 1.,
    a[2] == 2.}, a, {n, 1, 20}], PlotRange -> All]
 ]
```

可以看到，四条线彼此分得非常清楚，完美再现了基本不等式。

---

## 将初始值改成一般值

$$
a_{n+2}=\sqrt{a_{n+1}a_n},a_1=p,a_2=q
$$

### 平方平均

$$
a_n=\frac{\sqrt{(-1)^{n+1} 2^{2-n} (p-q) (p+q)+p^2+2 q^2}}{\sqrt{3}},n\to \infty ,a_n=\frac{\sqrt{p^2+2 q^2}}{\sqrt{3}}
$$

### 算术平均

$$
a_n=\frac{1}{3} 2^{-n} \left(2^n (p+2 q)-4 (-1)^n (p-q)\right),n\to \infty ,a_n=\frac{1}{3} (p+2 q)
$$

### 几何平均

$$
a_n=\sqrt[3]{p} q^{2/3} e^{-\frac{1}{3} (-1)^n 2^{2-n} (\log (p)-\log (q))},n\to \infty ,a_n=\sqrt[3]{p} q^{2/3}
$$

### 调和平均

$$
a_n=\frac{3\ 2^n p q}{4 (-1)^n (p-q)+2^n (2 p+q)},n\to \infty ,a_n=\frac{3 p q}{2 p+q}
$$

于是，我们得到了一个新的不等式链
$$
\frac{\sqrt{p^2+2 q^2}}{\sqrt{3}}\ge \frac{1}{3} (p+2 q)\ge \sqrt[3]{p} q^{2/3}\ge \frac{3 p q}{2 p+q}
$$

即三元的均值不等式链

## 然后进一步探索三元的

$$
a(n+3)=\frac{3}{\frac{1}{a(n+2)}+\frac{1}{a(n)}+\frac{1}{a(n+1)}},a(1)=p,a(2)=q,a(3)=r
$$

通项太长，不予录入

$$
\lim_{n\to \infty}a_n=\frac{6 p q r}{3 p q+2 p r+q r}=\frac{6}{3/r+2/q+1/p}
$$

同理

$$
a(n+3)=\frac{1}{3} (a(n+1)+a(n+2)+a(n))\\
\lim_{n\to \infty}a_n=\frac{1}{6} (p+2 q+3 r)\\
a(n+3)=\sqrt{\frac{1}{3} \left(a(n+1)^2+a(n+2)^2+a(n)^2\right)}\\
\lim_{n\to \infty}a_n=\frac{\sqrt{p^2+2 q^2+3 r^2}}{\sqrt{6}}\\
a(n+3)=\sqrt[3]{a(n+1) a(n) a(n+2)}\\
\lim_{n\to \infty}a_n=\sqrt[6]{p} \sqrt[3]{q} \sqrt{r}
$$

于是我们发现，可以通过这个递推式得到 $\frac{1}{2} n (n+1)$ 项的基本不等式

留一个证明题：以几何平均为例

$$
a(n+k)=\frac{a_n+a_{n+1}+\cdots a_{n+k-1}}{k}
,a_1,a_2,a_3\cdots a_k
$$

证

$$
\lim_{n\to \infty} a_n=\frac{a_1+2a_2+\cdots +ka_k}{\frac{1}{2} k (k+1)}
$$

可以尝试推广到
$$
f(x)=\left(\frac{\sum_{k=1}^n a_k^x}{n}\right)^{\frac1x}
$$

上式是 $x=1$ 的特殊情况

wuyudi 于 2019年5月29日18点39分